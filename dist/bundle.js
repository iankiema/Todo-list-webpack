(()=>{const e=document.getElementById("todo-form"),t=document.getElementById("task-input"),n=document.getElementById("task-list"),i=document.getElementById("btn-clear");let d=[];function a(){n.innerHTML="",d.forEach((e=>{const t=function(e){const t=document.createElement("li");t.className=`${e.completed?"completed":""} ${e.editing?"editing":""}`,t.setAttribute("draggable","true"),t.innerHTML=`\n    <input type="checkbox" ${e.completed?"checked":""}>\n    ${e.editing?`<input type="text" value="${e.description}">`:`<label>${e.description}</label>`}\n    <div class="task-actions">\n      <i class="fas fa-ellipsis-v task-more"></i>\n      <i class="fas fa-trash task-delete"></i>\n    </div>\n    <hr>\n  `,t.querySelector('input[type="checkbox"]').addEventListener("change",(()=>function(e){const t=d.find((t=>t.index===e));t&&(t.completed=!t.completed,s(),a())}(e.index)));const i=t.querySelector(".task-more"),r=t.querySelector(".task-delete");if(i.addEventListener("click",(()=>function(e){const t=d.find((t=>t.index===e));t&&(t.editing=!t.editing,s(),a())}(e.index))),r.addEventListener("click",(()=>{return t=e.index,d=d.filter((e=>e.index!==t)),s(),void a();var t})),e.editing){const n=t.querySelector('input[type="text"]');n.addEventListener("keydown",(t=>{if("Enter"===t.key){const t=n.value.trim();""!==t&&function(e,t){const n=d.find((t=>t.index===e));n&&(n.description=t,s(),a())}(e.index,t)}}))}return t.addEventListener("dragstart",(n=>{n.dataTransfer.setData("text/plain",e.index),t.classList.add("dragging")})),t.addEventListener("dragend",(()=>{t.classList.remove("dragging")})),t.addEventListener("dragover",(i=>{if(i.preventDefault(),i.dataTransfer.getData("text/plain"),e.index,document.querySelectorAll("#task-list li").forEach((e=>e.classList.remove("over"))),!t.classList.contains("dragging")){t.classList.add("over");const i=(d=e.index,[...document.querySelectorAll("#task-list li:not(.dragging)")].reduce(((e,t)=>{const n=t.getBoundingClientRect(),i=d<t.index?-15:15,a=Math.abs(i)-(d<t.index?0:n.height);return a<e.gap?{task:t,gap:a}:e}),{task:null,gap:Number.POSITIVE_INFINITY}).task);n.insertBefore(t,i)}var d})),t.addEventListener("drop",(t=>{t.preventDefault();const n=t.dataTransfer.getData("text/plain"),i=e.index,r=d.find((e=>e.index===parseInt(n,10))),c=d.find((e=>e.index===i)),o=r.index;r.index=c.index,c.index=o,s(),a()})),t}(e);n.appendChild(t)}))}function s(){localStorage.setItem("tasks",JSON.stringify(d))}e.addEventListener("submit",(e=>{e.preventDefault();const n=t.value.trim();""!==n&&(function(e){const t={description:e,completed:!1,index:d.length+1};d.push(t),s(),a()}(n),t.value="")})),i.addEventListener("click",(function(){d=d.filter((e=>!e.completed)),s(),a()})),document.addEventListener("DOMContentLoaded",(function(){const e=JSON.parse(localStorage.getItem("tasks"));e&&(d=e,a())}))})();